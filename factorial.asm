:main
PUSH 0
PUSH 0
POPREG Ax
POPM [Ax]
PUSH 0
PUSH 1
POPREG Ax
POPM [Ax]
IN
PUSH 0
POPREG Ax
POPM [Ax]
PUSH 0
POPREG Ax
PUSHM [Ax]
CALL :factorial
PUSH 1
POPREG Ax
POPM [Ax]
PUSH 1
POPREG Ax
PUSHM [Ax]
OUT
HLT
:factorial
PUSH 2
POPREG Ax
POPM [Ax]
PUSH 2
POPREG Ax
PUSHM [Ax]
PUSH 1
PUSH 0
POPREG Bx
JNE :endCompare1
PUSH 1
POPREG Bx
:endCompare1
PUSHREG Bx
PUSH 0
JE :endif1
PUSH 1
RET
:endif1
PUSH 2
POPREG Ax
PUSHM [Ax]
PUSH 1
PUSH 0
POPREG Bx
JE :endCompare2
PUSH 1
POPREG Bx
:endCompare2
PUSHREG Bx
PUSH 0
JE :endif2
PUSH 2
POPREG Ax
PUSHM [Ax]
PUSH 2
POPREG Ax
PUSHM [Ax]
PUSH 1
SUB
CALL :factorial
MUL
RET
:endif2
